---
title: "EDA Codebook"
author: "Sahithi R. Gangaram, Sangavi Manickavel, Tiger Liao"
date: "2024-07-22"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Ensure the necessary packages are installed
if (!requireNamespace("usmap", quietly = TRUE)) {
  install.packages("usmap")
}

if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}

if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}

# Load necessary libraries
library(tidyverse)
library(janitor)
library(usmap)
library(ggplot2)
library(maps)
library(datasets)
```

```{r}
# Install the tinytex package if not already installed
if (!requireNamespace("tinytex", quietly = TRUE)) {
  install.packages("tinytex")
}

# Install TinyTeX
tinytex::install_tinytex()

# Verify the installation
tinytex::is_tinytex()

```

## Introduction

This analysis explores trends in mental health treatment access in the United States using the National Mental Health Services Survey (N-MHSS) data from 2010. The aim is to investigate the geographical disparities in access to mental health treatment facilities and the distribution of different types of facilities, such as non-profit, public, and outpatient centers, across the US. Additionally, this study will examine whether there are differences in the utilization of mental health services based on the type of facility. By understanding these patterns, we hope to identify areas with limited access to mental health services and potential disparities in service utilization, which can inform policy and resource allocation decisions.

## Research Questions
1. What trends are there in mental health treatment access in the US based on geography and facility type?

2. Is there more access to treatment/facilities in certain geographic areas?

3. What is the distribution of types of facilities (non-profit, public, outpatient, etc.) across the US?

4. Is there a difference in the utilization of mental health services based on facility type?

## Data Exploration
# Reading and Cleaning Data


```{r}
# Load the dataset
load("C:/Users/Owner/Desktop/EDA Project/N-MHSS-2010-DS0001-data/N-MHSS-2010-DS0001-data-r.rda")

# Rename the dataset
dataset <- da34945.0001

# Preview the dataset
head(dataset)
unique(dataset)

# Extract variable names
variable_names <- colnames(dataset)

# Extract variable descriptions if available, otherwise use placeholder text
variable_descriptions <- sapply(variable_names, function(var) {
  attr <- attr(dataset[[var]], "label")
  if (is.null(attr)) {
    return("Description not available")
  } else {
    return(attr)
  }
})

# Create a dataframe with variable names and descriptions
variables_df <- data.frame(
  Variable = variable_names,
  Description = variable_descriptions
)

# Display the dataframe
knitr::kable(variables_df, caption = "Variables and Descriptions")

# Get the unique values and their counts for each variable
unique_counts <- dataset %>% 
  summarise(across(everything(), ~ n_distinct(.))) %>% 
  pivot_longer(everything(), names_to = "Variable", values_to = "Unique_Counts")

head(unique_counts)

```


```{r}
variable_descriptions <- c(
  CASEID = "Case Identification Number",
  STFIPS = "Census State FIPS codes label",
  MODE = "Control: Completes by phone/mail/web",
  MHINTAKE = "QA1_1 Facility offers intake services",
  MHDIAGEVAL = "QA1_2 Facility offers diagnostic evaluation",
  MHREFERRAL = "QA1_3 Facility offers information",
  SASERV = "QA1_4 Facility offers substance abuse treatment services",
  MENTALHTHSERV = "QA1_5 Facility offers mental health treatment services",
  ADMINSERV = "QA1_6 Facility offers administrative services",
  SETTINGIP = "QA3_1 Mental health treatment offered in hospital inpatient setting",
  SETTINGRC = "QA3_2 Mental health treatment offered in residential setting",
  SETTINGOP = "QA3_3 Mental health treatment offered in outpatient (or day treatment) setting",
  FACILITYTYPE = "QA5 Facility type",
  FOCUS = "QA6 Primary treatment focus",
  OWNERSHIP = "QA7 Facility is operated by",
  RELIGIOUS = "QA8 Facility is affiliated with a religious organization",
  TREATACTVTYTHRPY = "QA10_1 Facility offers activity therapy",
  TREATBEHAVMOD = "QA10_2 Facility offers behavior modification",
  TREATCOGTHRPY = "QA10_3 Facility offers cognitive/behavioral therapy",
  TREATFAMTHRPY = "QA10_4 Facility offers couples/family therapy",
  TREATELECTRO = "QA10_5 Facility offers electroconvulsive therapy",
  TREATGRPTHRPY = "QA10_6 Facility offers group therapy",
  TREATPSYCHOTHRPY = "QA10_7 Facility offers individual psychotherapy",
  TREATDUALMHSA = "QA10_8 Facility offers integrated dual disorders treatment",
  TREATPSYCHOMED = "QA10_9 Facility offers psychotropic medication therapy",
  TREATTEMEDINCE = "QA10_10 Facility offers telemedicine therapy",
  TREATOTH = "QA10_11 Facility offers other mental health treatment approaches",
  ASSERTCOMM = "QA11_1 Facility offers assertive community treatment",
  MHCASEMGMT = "QA11_2 Facility offers case management",
  MHCHRONIC = "QA11_3 Facility offers chronic disease/illness management",
  MHCONSUMER = "QA11_4 Facility offers consumer-run services",
  MHEDUCATION = "QA11_5 Facility offers education services",
  FAMPSYCHED = "QA11_6 Facility offers family psychoeducation",
  MHHOUSING = "QA11_7 Facility offers housing services",
  ILLNESSMGMT = "QA11_8 Facility offers illness management and recovery",
  MHLEGAL = "QA11_9 Facility offers legal advocacy services",
  MHEMGCY = "QA11_10 Facility offers psychiatric emergency walk-in services",
  MHPSYCHREHAB = "QA11_11 Facility offers psychosocial rehabilitation services",
  SMOKINGCESSATION = "QA11_12 Facility offers smoking cessation services",
  MHSUICIDE = "QA11_13 Facility offers suicide prevention services",
  SUPPEMPLOY = "QA11_14 Facility offers supported employment",
  SUPPHOUSING = "QA11_15 Facility offers supported housing",
  FOSTERCARE = "QA11_16 Facility offers therapeutic foster care",
  MHVOCREHAB = "QA11_17 Facility offers vocational rehabilitation services",
  MHOTH = "QA11_18 Facility offers other supportive services",
  CHILDADOL = "QA12_1 Youth accepted at facility",
  ADULTS = "QA12_2 Adults accepted at facility",
  SENIORS = "QA12_3 Seniors accepted at facility",
  SED = "QA13_1 Offers program designed for youth with SED",
  TRANSITIONAGE = "QA13_2 Offers program designed for transition-aged young adults",
  SPMI = "QA13_3 Offers program designed for adults with SMI",
  ALZHDEMENTIA = "QA13_4 Offers program designed for individuals with Alzheimer's or dementia",
  MHANDSA = "QA13_5 Offers program designed for co-occurring mental health and substance abuse disorders",
  MHANDOTHER = "QA13_6 Offers program designed for co-occurring mental health and non-substance abuse disorders",
  POSTTRAUM = "QA13_7 Offers program designed for individuals with post-traumatic stress disorder",
  VETERNS = "QA13_8 Offers program designed for veterans",
  TRAUMATICBRAIN = "QA13_9 Offers program designed for individuals with TBI",
  GLBT = "QA13_10 Offers program designed for gay, lesbian, bisexual, or transgendered clients",
  FORENSIC = "QA13_11 Offers program designed for forensic clients",
  PROGOTH = "QA13_12 Offers program designed for other specific populations",
  HEARIMPAIR = "QA13_13 Offers program designed for individuals with hearing impairments",
  LAGENENGLISH = "QA15_1 Provides mental health treatment services in English",
  LANGSPANISH = "QA15_2 Provides mental health treatment services in Spanish",
  LANGOTH = "QA15_3 Provides mental health treatment services in other language",
  CRISISTEAM = "QA16 Operates a crisis intervention team",
  COMPRESULTRPTG = "QA17_1 Uses computerized system for reporting results",
  COMPCPOE = "QA17_2 Uses computerized system for physician order entry of patient prescriptions or directions",
  COMPCLINDATA = "QA17_3 Uses computerized system for sending and receiving clinical data",
  COMPTREATPLAN = "QA17_4 Uses computerized system for creating and maintaining treatment plans",
  COMPSATISYSURVEY = "QA17_5 Uses computerized system for client or family satisfaction surveys",
  COMPMEDCHECK = "QA17_6 Uses computerized system for checking medication interactions",
  COMPBILLING = "QA17_7 Uses computerized system for preparing and submitting bills or claims",
  COMPPATIENTSCHED = "QA17_8 Uses computerized system for scheduling clients/patients",
  COMPPROCESSNOTE = "QA17_9 Uses computerized system for process note-taking",
  COMPOTH = "QA17_10 Uses computerized system for other operational function",
  EDUCREQUIRE = "QA18_1 Monitors continuing education requirements for staff",
  CASEREVIEW = "QA18_2 Regularly schedules case review with a supervisor",
  COMMITTEE = "QA18_3 Regularly schedules case review by a quality review committee",
  OUTCOME = "QA18_4 Client/patient outcome follow-up after discharge",
  UTILIZATION = "QA18_5 Periodic utilization review",
  SATISFYSURVEY = "QA18_6 Periodic client/patient satisfaction surveys",
  NOCHARGE = "QA19 Offers treatment at no charge to clients/patients",
  FUNDMEDICAID = "QA21_1 Facility accepts Medicaid",
  FUNDMEDICARE = "QA21_2 Facility accepts Medicare",
  FUNDSMHA = "QA21_3 Facility accepts state mental health agency funds",
  FUNDSTATEWELFARE = "QA21_4 Facility accepts state welfare or child or family services agency funds",
  FUNDSTATEJUV = "QA21_5 Facility accepts state corrections or juvenile justice agency funds",
  FUNDSTATEEDUC = "QA21_6 Facility accepts state education agency funds",
  FUNDLOCALGOV = "QA21_7 Facility accepts local government funds",
  FUNDVA = "QA21_8 Facility accepts (US Department of Veterans Affairs) VA funds",
  FUNDCSBG = "QA21_9 Facility accepts Community Service Block Grants",
  FUNDCMHG = "QA21_10 Facility accepts Community Mental Health Block Grants",
  FUNDCLIENTFEES = "QA21_11 Facility accepts client/patient fees",
  FUNDPRVTINS = "QA21_12 Facility accepts private insurance",
  FUNDOTHPUB = "QA21_13 Facility accepts other public funds",
  FUNDOTHPRVT = "QA21_14 Facility accepts other private funds",
  MAJORSINGLEFUND = "QA22 More than half of facility funds come from a single source",
  MAJORFUNDTYPE = "QA22a The single source that funds more than half of the facility",
  SMOKINGPOLICY = "QA23 Facility smoking policy",
  USEDSECLUSION = "QA24 Facility used seclusion or restraint",
  ADOPTSECLUSION = "QA25 Facility adopted evidence-based practices",
  LICENSESMHA = "QA25_1 Facility has licensing/certification/accreditation from state mental health agency",
  LICENSESA = "QA25_2 Facility has licensing/certification/accreditation from state substance abuse agency",
  LICENSEDPH = "QA25_3 Facility has licensing/certification/accreditation from state department of health",
  LICENSEHOSPLIC = "QA25_4 Facility has licensing/certification/accreditation from hospital licensing authority",
  LICENSEJC = "QA25_5 Facility has licensing/certification/accreditation from JC (Joint Commission)",
  LICENSECARF = "QA25_6 Facility has licensing/certification/accreditation from CARF (Commission on Accreditation of Rehabilitation Facilities)",
  LICENSECOA = "QA25_7 Facility has licensing/certification/accreditation from COA (Council on Accreditation)",
  LICENSEDFCS = "QA25_8 Facility has licensing/certification/accreditation from Department of Family and Children Services",
  LICENSEDHHS = "QA25_9 Facility has licensing/certification/accreditation from US Dept of Health and Human Services",
  LICENSEMEDICARE = "QA25_10 Facility has licensing/certification/accreditation from Medicare",
  LICENSEMEDICAID = "QA25_11 Facility has licensing/certification/accreditation from Medicaid",
  LICENSEOTHORG = "QA25_12 Facility has licensing/certification/accreditation from other national/state/local organization",
  FACONLY = "QB1 Client/patient counts reported for only this facility",
  TOTALFAC = "QB2_3 Total number of facilities included in reported client/patient counts",
  IPSERV = "QB3 Patients received services in 24-hour hospital inpatient setting",
  IPTOTAL = "QB3a Number of patients that received 24-hour hospital inpatient services",
  IPSEXTOTM = "QB3b_num_mal Male hospital inpatients - Total",
  IPSEXPERM = "QB3b_per_mal Male hospital inpatients - Percent",
  IPSEXTOTF = "QB3b_num_fem Female hospital inpatients - Total",
  IPSEXPERF = "QB3b_per_fem Female hospital inpatients - Percent",
  IPAGETOT017 = "QB3b_num_age1 Ages 0-17 hospital inpatients - Total",
  IPAGEPER017 = "QB3b_per_age1 Ages 0-17 hospital inpatients - Percent",
  IPAGETOT1864 = "QB3b_num_age2 Ages 18-64 hospital inpatients - Total",
  IPAGEPER1864 = "QB3b_per_age2 Ages 18-64 hospital inpatients - Percent",
  IPAGETOT65 = "QB3b_num_age3 Ages 65+ hospital inpatients - Total",
  IPAGEPER65 = "QB3b_per_age3 Ages 65+ hospital inpatients - Percent",
  IPETHTOTHISP = "QB3b_num_his Total Hispanic or Latino hospital inpatients",
  IPETHPERHISP = "QB3b_per_his Percent Hispanic or Latino hospital inpatients",
  IPETHTOTNONHISP = "QB3b_num_nhis Total non-Hispanic or Latino hospital inpatients",
  IPETHPERNONHISP = "QB3b_per_nhis Percent non-Hispanic or Latino hospital inpatients",
  IPETHTOTUNK = "QB3_num_ethunk Ethnicity unknown - Total hospital inpatients",
  IPRACETOTINDIAN = "QB3b_num_indian Total American Indian or Alaska Native hospital inpatients",
  IPRACEPERINDIAN = "QB3b_per_indian Percent American Indian or Alaska Native hospital inpatients",
  IPRACETOTASIAN = "QB3b_num_asian Total Asian hospital inpatients",
  IPRACEPERASIAN = "QB3b_per_asian Percent Asian hospital inpatients",
  IPRACETOTBLK = "QB3b_num_blk Total Black or African American hospital inpatients",
  IPRACEPERBLK = "QB3b_per_blk Percent Black or African American hospital inpatients",
  IPRACETOTHAWPAC = "QB3b_num_hawpac Total Native Hawaiian or Other Pacific Islander hospital inpatients",
  IPRACEPERHAWPAC = "QB3b_per_hawpac Percent Native Hawaiian or Other Pacific Islander hospital inpatients",
  IPRACETOTWHIT = "QB3b_num_whit Total White hospital inpatients",
  IPRACEPERWHIT = "QB3b_per_whit Percent White hospital inpatients",
  IPRACETOTMR = "QB3b_num_mr Total Two or more races hospital inpatients",
  IPRACEPERMR = "QB3b_per_mr Percent Two or more races hospital inpatients",
  IPRACETOTUNK = "QB3_num_raceunk Race unknown - Total hospital inpatients",
  IPRACEPERUNK = "QB3_per_raceunk Percent race unknown hospital inpatients",
  IPLEGALTOTVOL = "QB3b_num_vol Total voluntarily admitted hospital inpatients",
  IPLEGALPERVOL = "QB3b_per_vol Percent voluntarily admitted hospital inpatients",
  IPLEGALTOTNONFOREN = "QB3b_num_nonforen Total non-forensic hospital inpatients",
  IPLEGALPERNONFOREN = "QB3b_per_nonforen Percent non-forensic hospital inpatients",
  IPLEGALTOTFOREN = "QB3b_num_foren Total forensic hospital inpatients",
  IPLEGALPERFOREN = "QB3b_per_foren Percent forensic hospital inpatients",
  IPBEDS = "QB3b_beds Total hospital inpatient beds",
  RCSERV = "QC1 Patients received services in residential treatment center",
  RCTOTAL = "QC1a Number of patients that received residential treatment services",
  RCSEXTOTM = "QC1b_num_mal Male residential treatment center patients - Total",
  RCSEXPERM = "QC1b_per_mal Male residential treatment center patients - Percent",
  RCSEXTOTF = "QC1b_num_fem Female residential treatment center patients - Total",
  RCSEXPERF = "QC1b_per_fem Female residential treatment center patients - Percent",
  RCAGETOT017 = "QC1b_num_age1 Ages 0-17 residential treatment center patients - Total",
  RCAGEPER017 = "QC1b_per_age1 Ages 0-17 residential treatment center patients - Percent",
  RCAGETOT1864 = "QC1b_num_age2 Ages 18-64 residential treatment center patients - Total",
  RCAGEPER1864 = "QC1b_per_age2 Ages 18-64 residential treatment center patients - Percent",
  RCAGETOT65 = "QC1b_num_age3 Ages 65+ residential treatment center patients - Total",
  RCAGEPER65 = "QC1b_per_age3 Ages 65+ residential treatment center patients - Percent",
  RCETHTOTHISP = "QC1b_num_his Total Hispanic or Latino residential treatment center patients",
  RCETHPERHISP = "QC1b_per_his Percent Hispanic or Latino residential treatment center patients",
  RCETHTOTUNK = "QC1_num_ethunk Ethnicity unknown - Total residential treatment center patients",
  RCETHPERUNK = "QC1_per_ethunk Percent ethnicity unknown residential treatment center patients",
  RCRACETOTINDIAN = "QC1b_num_indian Total American Indian or Alaska Native residential treatment center patients",
  RCRACEPERINDIAN = "QC1b_per_indian Percent American Indian or Alaska Native residential treatment center patients",
  RCRACETOTASIAN = "QC1b_num_asian Total Asian residential treatment center patients",
  RCRACEPERASIAN = "QC1b_per_asian Percent Asian residential treatment center patients",
  RCRACETOTBLK = "QC1b_num_blk Total Black or African American residential treatment center patients",
  RCRACEPERBLK = "QC1b_per_blk Percent Black or African American residential treatment center patients",
  RCRACETOTHAWPAC = "QC1b_num_hawpac Total Native Hawaiian or Other Pacific Islander residential treatment center patients",
  RCRACEPERHAWPAC = "QC1b_per_hawpac Percent Native Hawaiian or Other Pacific Islander residential treatment center patients",
  RCRACETOTWHIT = "QC1b_num_whit Total White residential treatment center patients",
  RCRACEPERWHIT = "QC1b_per_whit Percent White residential treatment center patients",
  RCRACETOTMR = "QC1b_num_mr Total Two or more races residential treatment center patients",
  RCRACEPERMR = "QC1b_per_mr Percent Two or more races residential treatment center patients",
  RCRACETOTUNK = "QC1_num_raceunk Race unknown - Total residential treatment center patients",
  RCRACEPERUNK = "QC1_per_raceunk Percent race unknown residential treatment center patients",
  RCLEGALTOTVOL = "QB4b_num_vol Voluntary legal status - Total residential care clients",
  RCLEGALPERVOL = "QB4b_per_vol Voluntary legal status - Percent residential care clients",
  RCLEGALTOTNONFOREN = "QB4b_num_inn Involuntary (non-forensic) legal status - Total residential care clients",
  RCLEGALPERNONFOREN = "QB4b_per_inn Involuntary (non-forensic) legal status - Percent residential care clients",
  RCLEGALTOTFOREN = "QB4b_num_inf Involuntary (forensic) legal status - Total residential care clients",
  RCLEGALPERFOREN = "QB4b_per_inf Involuntary (forensic) legal status - Percent residential care clients",
  RCBEDS = "QB4c Number of residential beds specifically designated for mental health",
  OPSERV = "QB5 Clients received services in an outpatient setting",
  OPTOTAL = "QB5a Number of clients that received outpatient (or day treatment/partial hospitalization) services",
  OPSEXTOTM = "QB5b_num_mal Male outpatients - Total",
  OPSEXPERM = "QB5b_per_mal Male outpatients - Percent",
  OPSEXTOTF = "QB5b_num_fem Female outpatients - Total",
  OPSEXPERF = "QB5b_per_fem Female outpatients - Percent",
  OPAGETOT017 = "QB5b_num_age1 Ages 0-17 outpatients - Total",
  OPAGEPER017 = "QB5b_per_age1 Ages 0-17 outpatients - Percent",
  OPAGETOT1864 = "QB5b_num_age2 Ages 18-64 outpatients - Total",
  OPAGEPER1864 = "QB5b_per_age2 Ages 18-64 outpatients - Percent",
  OPAGETOT65 = "QB5b_num_age3 Ages 65+ outpatients - Total",
  OPAGEPER65 = "QB5b_per_age3 Ages 65+ outpatients - Percent",
  OPETHTOTHISP = "QB5b_num_his Total Hispanic or Latino outpatients",
  OPETHPERHISP = "QB5b_per_his Percent Hispanic or Latino outpatients",
  OPETHTOTNONHISP = "QB5b_num_nhis Total non-Hispanic or Latino outpatients",
  OPETHPERNONHISP = "QB5b_per_nhis Percent non-Hispanic or Latino outpatients",
  OPETHTOTUNK = "QB5_num_ethunk Ethnicity unknown - Total outpatients",
  OPETHPERUNK = "QB5_per_ethunk Ethnicity unknown - Percent outpatients",
  OPRACETOTINDIAN = "QB5b_num_nat Total American Indian/Alaska Native outpatients",
  OPRACEPERINDIAN = "QB5b_per_nat Percent American Indian/Alaska Native outpatients",
  OPRACETOTASIAN = "QB5b_num_asian Total Asian outpatients",
  OPRACEPERASIAN = "QB5b_per_asian Percent Asian outpatients",
  OPRACETOTBLK = "QB5b_num_blk Total Black or African American outpatients",
  OPRACEPERBLK = "QB5b_per_blk Percent Black or African American outpatients",
  OPRACETOTHAWPAC = "QB5b_num_hawpac Total Native Hawaiian or Other Pacific Islander outpatients",
  OPRACEPERHAWPAC = "QB5b_per_hawpac Percent Native Hawaiian or Other Pacific Islander outpatients",
  OPRACETOTWHIT = "QB5b_num_whit Total White outpatients",
  OPRACEPERWHIT = "QB5b_per_whit Percent White outpatients",
  OPRACETOTMR = "QB5b_num_mr Total Two or more races outpatients",
  OPRACEPERMR = "QB5b_per_mr Percent Two or more races outpatients",
  OPRACETOTUNK = "QB5_num_raceunk Race unknown - Total outpatients",
  OPRACEPERUNK = "QB5_per_raceunk Percent race unknown outpatients",
  OPLEGALTOTVOL = "QB5b_num_vol Total voluntarily admitted outpatients",
  OPLEGALPERVOL = "QB5b_per_vol Percent voluntarily admitted outpatients",
  OPLEGALTOTNONFOREN = "QB5b_num_nonforen Total non-forensic outpatients",
  OPLEGALPERNONFOREN = "QB5b_per_nonforen Percent non-forensic outpatients",
  OPLEGALTOTFOREN = "QB5b_num_foren Total forensic outpatients",
  OPLEGALPERFOREN = "QB5b_per_foren Percent forensic outpatients",
  PERCENTCP = "QB5b_per_cp Percent of outpatients with civil commitment",
  MHADMISSIONS = "QB5c Mental health admissions during April 2010",
  PERCENTVA = "QB5d Percent of outpatients served by Veterans Affairs",
  SRVCHAR = "QB6 Characteristics of services provided by the facility"
)


```


```{r}
variables_df <- data.frame(
  Variable = names(variable_descriptions),
  Description = unname(variable_descriptions))

# Display the dataframe
knitr::kable(variables_df, caption = "Variables and Descriptions")

```
## Visualizing Data

```{r}
# # Visualizing Data
# # Geographical distribution of facilities
# facility_counts <- dataset %>%
#   count(STFIPS) %>%
#   rename(fips = STFIPS, value = n)
# 
# # Convert FIPS to state names
# facility_counts$fips <- as.numeric(facility_counts$fips)
# facility_counts <- facility_counts %>%
#   mutate(state = usmap::fips_to_abbr(fips))
# 
# plot_usmap(data = facility_counts, values = "value", color = "white") +
#   scale_fill_continuous(low = "white", high = "blue", name = "Number of Facilities", label = scales::comma) +
#   labs(title = "Geographical Distribution of Mental Health Facilities", subtitle = "Data from N-MHSS 2010") +
#   theme(legend.position = "right")
# 
# # Sex distribution of patients
# dataset %>%
#   count(OPSEXTOTM, OPSEXTOTF) %>%
#   pivot_longer(cols = c(OPSEXTOTM, OPSEXTOTF), names_to = "Sex", values_to = "Count") %>%
#   ggplot(aes(x = Sex, y = Count, fill = Sex)) +
#   geom_bar(stat = "identity") +
#   labs(title = "Sex Distribution of Outpatients", x = "Sex", y = "Number of Outpatients") +
#   theme_minimal()
```

## Statistical Metrics 
```{r}
# Calculating central tendency measures for key variables
summary_stats <- dataset %>%
  summarise(
    mean_male_outpatients = mean(OPSEXTOTM, na.rm = TRUE),
    median_male_outpatients = median(OPSEXTOTM, na.rm = TRUE),
    sd_male_outpatients = sd(OPSEXTOTM, na.rm = TRUE),
    mean_female_outpatients = mean(OPSEXTOTF, na.rm = TRUE),
    median_female_outpatients = median(OPSEXTOTF, na.rm = TRUE),
    sd_female_outpatients = sd(OPSEXTOTF, na.rm = TRUE)
  )

summary_stats

# Correlational analysis between male and female outpatients
cor(dataset$OPSEXTOTM, dataset$OPSEXTOTF, use = "complete.obs")


```
```{r}
table(dataset$STFIPS)
unique(dataset$STFIPS)
```
## Analysis

From the initial visualizations, we observe that the geographical distribution of mental health facilities varies significantly across different states, with certain areas having a higher concentration of facilities. The sex distribution analysis shows that there is a disparity in the number of male and female outpatients.

## Looking Forward

The initial analysis suggests further investigation into:

* The intersectionality of age, gender, and race in accessing mental health care, such as comparing younger Caucasian females with older Black males to identify barriers.

* The impact of access disparities on overall health outcomes among specific demographic groups.

* Evaluating which types of facilities (e.g., non-profit, public) are most accessible and provide the best outcomes.

* Assessing whether the prevalence of certain facility focuses, like substance abuse treatment, aligns with the prevalence of those issues in the population.

* Exploring additional data points and refining research questions based on these preliminary findings to inform future policy and resource allocation.
